


<h1><a name="getting_started_with_jme3_4_-_hello_event_loop" id="getting_started_with_jme3_4_-_hello_event_loop">Getting Started with JME3 (4) - Hello Event Loop</a></h1>
<div class="level1">

<p>

<br/>

Previous: <a href="/com/jme3/gde/core/docs/jme3/beginner/hello_asset.html" class="wikilink1" title="jme3:beginner:hello_asset">Hello Assets</a>,
Next: <a href="/com/jme3/gde/core/docs/jme3/beginner/hello_input_system.html" class="wikilink1" title="jme3:beginner:hello_input_system">Hello Input System</a>
<br/>

<br/>

Now that you now how to load assets such as 3-D models, you want them to implement the actual gameplay. The event loop of your game is where the action happens.
</p>

</div>
<!-- SECTION "Getting Started with JME3 (4) - Hello Event Loop" [1-353] -->
<h2><a name="code_sample" id="code_sample">Code Sample</a></h2>
<div class="level2">
<pre class="code java"><span class="kw1">package</span> <span class="co2">jme3test.helloworld</span>;
&nbsp;
<span class="kw1">import</span> <span class="co2">com.jme3.app.SimpleApplication</span>;
<span class="kw1">import</span> <span class="co2">com.jme3.material.Material</span>;
<span class="kw1">import</span> <span class="co2">com.jme3.math.ColorRGBA</span>;
<span class="kw1">import</span> <span class="co2">com.jme3.math.Vector3f</span>;
<span class="kw1">import</span> <span class="co2">com.jme3.scene.Geometry</span>;
<span class="kw1">import</span> <span class="co2">com.jme3.scene.shape.Box</span>;
&nbsp;
<span class="co3">/** Sample 4 - how to trigger repeating actions from the main event loop.
 * In this example, we make the player character rotate. */</span>
<span class="kw1">public</span> <span class="kw1">class</span> HelloLoop <span class="kw1">extends</span> SimpleApplication <span class="br0">&#123;</span>
&nbsp;
    <span class="kw1">public</span> <span class="kw1">static</span> <span class="kw4">void</span> main<span class="br0">&#40;</span><object classid="java:org.netbeans.modules.javahelp.BrowserDisplayer"><param name="content" value="http://www.google.com/search?hl=en&amp;q=allinurl%3Astring+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><param name="text" value="<html><u></u></html>"><param name="textColor" value="blue"></object><span class="br0">&#91;</span><span class="br0">&#93;</span> args<span class="br0">&#41;</span><span class="br0">&#123;</span>
        HelloLoop app <span class="sy0">=</span> <span class="kw1">new</span> HelloLoop<span class="br0">&#40;</span><span class="br0">&#41;</span>;
        app.<span class="me1">start</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
    <span class="br0">&#125;</span>
&nbsp;
    <span class="kw1">protected</span> Geometry player;
&nbsp;
    @Override
    <span class="kw1">public</span> <span class="kw4">void</span> simpleInitApp<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
&nbsp;
        <object classid="java:org.netbeans.modules.javahelp.BrowserDisplayer"><param name="content" value="http://www.google.com/search?hl=en&amp;q=allinurl%3Abox+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><param name="text" value="<html><u></u></html>"><param name="textColor" value="blue"></object><span class="br0">&#40;</span>Vector3f.<span class="me1">ZERO</span>, <span class="nu0">1</span>, <span class="nu0">1</span>, <span class="nu0">1</span><span class="br0">&#41;</span>;
        player <span class="sy0">=</span> <span class="kw1">new</span> Geometry<span class="br0">&#40;</span><span class="st0">&quot;blue cube&quot;</span>, b<span class="br0">&#41;</span>;
        Material mat <span class="sy0">=</span> <span class="kw1">new</span> Material<span class="br0">&#40;</span>assetManager, <span class="st0">&quot;Common/MatDefs/Misc/SolidColor.j3md&quot;</span><span class="br0">&#41;</span>;
        mat.<span class="me1">setColor</span><span class="br0">&#40;</span><span class="st0">&quot;m_Color&quot;</span>, ColorRGBA.<span class="me1">Blue</span><span class="br0">&#41;</span>;
        player.<span class="me1">setMaterial</span><span class="br0">&#40;</span>mat<span class="br0">&#41;</span>;
        rootNode.<span class="me1">attachChild</span><span class="br0">&#40;</span>player<span class="br0">&#41;</span>;
    <span class="br0">&#125;</span>
&nbsp;
    <span class="coMULTI">/* This is the main event loop */</span>
    @Override
    <span class="kw1">public</span> <span class="kw4">void</span> simpleUpdate<span class="br0">&#40;</span><span class="kw4">float</span> tpf<span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="co1">// make the player rotate</span>
        player.<span class="me1">rotate</span><span class="br0">&#40;</span>0, <span class="nu0">2</span><span class="sy0">*</span>tpf, 0<span class="br0">&#41;</span>; 
    <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>
<p>
Build and run the file: You see a constantly rotating cube. 
</p>

</div>
<!-- SECTION "Code Sample" [354-1559] -->
<h2><a name="understanding_the_code" id="understanding_the_code">Understanding the Code</a></h2>
<div class="level2">

<p>

Compared to our previous code samples you note that the player Geometry is now a class field. This is because we want the main event loop to be able to access and transform this Geometry. As you can see, we initialize the player object in the <code>simpleInitApp()</code> method. 
</p>

<p>
<br/>

Now have a closer look at the <code>simpleUpdate()</code> method, this is the main event loop. 
</p>
<ul>
<li class="level1"><div class="li"> The <code>player.rotate(0, 2*tpf, 0);</code> line changes the rotation of the player object. </div>
</li>
<li class="level1"><div class="li"> We use the <code>tpf</code> variable (“time per frame”) to time this action depending on the current frames per second rate. This means the cube rotates with the same speed on fast machines, and the game remains playable.</div>
</li>
</ul>

</div>
<!-- SECTION "Understanding the Code" [1560-2265] -->
<h2><a name="the_event_loop" id="the_event_loop">The Event Loop</a></h2>
<div class="level2">

<p>

A rotating object is just a simple example. In the event loop, you can update score and health points, check for collisions, make enemies calculate their next move, roll the dice whether a trap has been set off, play random ambient sounds, and much more.  
</p>

<p>
<br/>

</p>
<ul>
<li class="level1"><div class="li"> The event loop starts after the <code>simpleInitApp()</code> method has set up the scenegraph and state variables.</div>
</li>
<li class="level1"><div class="li"> JME executes everything in the <code>simpleUpdate()</code> method repeatedly, as fast as possible.</div>
<ol>
<li class="level2"><div class="li"> Use the loop to poll the game state and initiate actions. </div>
</li>
<li class="level2"><div class="li"> Use the loop to trigger reactions and update the game state.</div>
</li>
<li class="level2"><div class="li"> Use it wisely, because having too many calls in the loop also slows down the game. </div>
</li>
</ol>
</li>
</ul>

</div>
<!-- SECTION "The Event Loop" [2266-2981] -->
<h2><a name="exercises" id="exercises">Exercises</a></h2>
<div class="level2">

<p>

Here are some fun things to try:
</p>
<ol>
<li class="level1"><div class="li"> What happens if you give the rotate() method negative numbers?</div>
</li>
<li class="level1"><div class="li"> Can you create two models next to each other, and make one rotate twice as fast as the other? (use the <code>tpf</code>)</div>
</li>
<li class="level1"><div class="li"> Can you make a cube that pulsates regularily? (grow and shrink its scale)</div>
</li>
<li class="level1"><div class="li"> Can you make a rolling cube? (spin around the x axis, and translate along the z axis)</div>
</li>
</ol>

<p>

Look back at the <a href="/com/jme3/gde/core/docs/jme3/beginner/hello_node.html" class="wikilink1" title="jme3:beginner:hello_node">Hello Node</a> tutorial if you do not remember the transformation methods for scaling, translating, and rotating.
</p>

</div>
<!-- SECTION "Exercises" [2982-3521] -->
<h2><a name="conclusion" id="conclusion">Conclusion</a></h2>
<div class="level2">

<p>

Now you are “listening to the heart beat” of the game and you can add some action. Now the next thing the game needs is some <em>inter</em>action! Continue learning how to <a href="/com/jme3/gde/core/docs/jme3/beginner/hello_input_system.html" class="wikilink1" title="jme3:beginner:hello_input_system">respond to user input</a>.

</p>

</div>
<!-- SECTION "Conclusion" [3522-] -->
<p><em><a href="http://jmonkeyengine.org/wiki/doku.php/jme3:beginner:hello_main_event_loop?do=export_xhtmlbody">view online version</a></em></p>