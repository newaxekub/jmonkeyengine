


<h1><a name="input_handling" id="input_handling">Input Handling</a></h1>
<div class="level1">

<p>

Users interact with your jME3 application with different input devices – the mouse, the keyboard, or a joystick. To respond to inputs we use the <code>inputManager</code> object in <code>SimpleApplication</code>.
</p>

<p>
This is how you add interaction to your game:

</p>
<ol>
<li class="level1"><div class="li"> For each action, choose the trigger(s) (a key or mouse click etc)</div>
</li>
<li class="level1"><div class="li"> For each action, add a trigger mapping to the inputManager</div>
</li>
<li class="level1"><div class="li"> Create at least one listener in SimpleApplication</div>
</li>
<li class="level1"><div class="li"> For each action, register its mappings to a listener</div>
</li>
<li class="level1"><div class="li"> Implement each action in the listener</div>
</li>
</ol>

</div>
<!-- SECTION "Input Handling" [1-561] -->
<h2><a name="choose_trigger" id="choose_trigger">1. Choose Trigger</a></h2>
<div class="level2">

<p>

Choose one or several key/mouse events for the interaction. We use <code>KeyTrigger</code>, <code>MouseAxisTrigger</code>, <code>MouseButtonTrigger</code>, <code>JoyAxisTrigger</code> and <code>JoyButtonTrigger</code> constants from the <code>com.jme3.input.controls</code> package.

</p>
<table class="inline">
	<tr class="row0">
		<th class="col0"> Trigger </th><th class="col1"> Code </th>
	</tr>
	<tr class="row1">
		<td class="col0"> Mouse button: Left Click </td><td class="col1"> MouseButtonTrigger(MouseInput.BUTTON_LEFT) </td>
	</tr>
	<tr class="row2">
		<td class="col0"> Mouse button: Right Click </td><td class="col1"> MouseButtonTrigger(MouseInput.BUTTON_RIGHT) </td>
	</tr>
	<tr class="row3">
		<td class="col0"> Mouse button: Middle Click </td><td class="col1"> MouseButtonTrigger(MouseInput.BUTTON_MIDDLE) </td>
	</tr>
	<tr class="row4">
		<td class="col0"> Mouse movement: </td><td class="col1"> MouseAxisTrigger(MouseInput.AXIS_X, true), MouseAxisTrigger(MouseInput.AXIS_Y, true) </td>
	</tr>
	<tr class="row5">
		<td class="col0"> Mouse wheel: </td><td class="col1"> MouseAxisTrigger(AXIS_WHEEL,true) </td>
	</tr>
	<tr class="row6">
		<td class="col0"> Keyboard: Characters and Numbers etc </td><td class="col1"> KeyTrigger(KeyInput.KEY_X) etc </td>
	</tr>
	<tr class="row7">
		<td class="col0 leftalign"> Keyboard: Spacebar  </td><td class="col1"> KeyTrigger(KeyInput.KEY_SPACE) </td>
	</tr>
	<tr class="row8">
		<td class="col0"> Keyboard: Shift </td><td class="col1"> KeyTrigger(KeyInput.KEY_RSHIFT), KeyTrigger(KeyInput.KEY_LSHIFT) </td>
	</tr>
	<tr class="row9">
		<td class="col0"> Keyboard: F1 etc </td><td class="col1"> KeyTrigger(KeyInput.KEY_F1) etc </td>
	</tr>
	<tr class="row10">
		<td class="col0"> Keyboard: Return, Enter </td><td class="col1 leftalign"> KeyTrigger(KeyInput.KEY_RETURN), KeyTrigger(KeyInput.KEY_NUMPADENTER)  </td>
	</tr>
	<tr class="row11">
		<td class="col0"> Keyboard: PageUp, PageDown </td><td class="col1"> KeyTrigger(KeyInput.KEY_PGUP) , KeyTrigger(KeyInput.KEY_PGDN) </td>
	</tr>
	<tr class="row12">
		<td class="col0"> Keyboard: Delete, Backspace </td><td class="col1"> KeyTrigger(KeyInput.KEY_BACK), KeyTrigger(KeyInput.KEY_DELETE) </td>
	</tr>
	<tr class="row13">
		<td class="col0"> Keyboard: Escape </td><td class="col1"> KeyTrigger(KeyInput.KEY_ESCAPE) </td>
	</tr>
	<tr class="row14">
		<td class="col0"> Keyboard: Arrows </td><td class="col1"> KeyTrigger(KeyInput.KEY_DOWN), KeyTrigger(KeyInput.KEY_UP) <br/>
 KeyTrigger(KeyInput.KEY_LEFT), KeyTrigger(KeyInput.KEY_RIGHT) </td>
	</tr>
	<tr class="row15">
		<td class="col0"> NumPad: Number 1 etc </td><td class="col1"> KeyTrigger(KeyInput.KEY_NUMPAD1) etc </td>
	</tr>
	<tr class="row16">
		<td class="col0"> Joystick: Button </td><td class="col1"> JoyButtonTrigger(0, joyInput.POV_X) ? </td>
	</tr>
	<tr class="row17">
		<td class="col0"> Joystick: Movement </td><td class="col1"> JoyAxisTrigger(0,JoyInput.AXIS_X, true), JoyAxisTrigger(0,JoyInput.AXIS_X, true), <br/>
 JoyAxisTrigger(0,JoyInput.AXIS_Z, true), JoyAxisTrigger(0,JoyInput.AXIS_Z_ROT, true) ? </td>
	</tr>
</table>

<p>

The booleans are used to negate the axes, if necessary. 
</p>

</div>
<!-- SECTION "1. Choose Trigger" [562-2380] -->
<h2><a name="add_a_trigger_mapping" id="add_a_trigger_mapping">2. Add a Trigger Mapping</a></h2>
<div class="level2">

<p>

When initializing the application, add a Mapping for each Trigger. 
</p>

<p>
Give the mapping a meaningful name. The name should reflect the action, not the key, since the keys can change. Here some examples:
</p>
<pre class="code java">inputManager.<span class="me1">addMapping</span><span class="br0">&#40;</span><span class="st0">&quot;Pause Game&quot;</span>, <span class="kw1">new</span> KeyTrigger<span class="br0">&#40;</span>KeyInput.<span class="me1">KEY_P</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
inputManager.<span class="me1">addMapping</span><span class="br0">&#40;</span><span class="st0">&quot;Rotate&quot;</span>,     <span class="kw1">new</span> KeyTrigger<span class="br0">&#40;</span>KeyInput.<span class="me1">KEY_SPACE</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;</pre>
<p>
There are cases where you may want more then one trigger for one action. For instance some users prefer the WASD keys to navigate, others prefer the arrow keys. You can define both by adding them after a comma.
</p>
<pre class="code java">inputManager.<span class="me1">addMapping</span><span class="br0">&#40;</span><span class="st0">&quot;Left&quot;</span>,  <span class="kw1">new</span> KeyTrigger<span class="br0">&#40;</span>KeyInput.<span class="me1">KEY_A</span><span class="br0">&#41;</span>, 
                                 <span class="kw1">new</span> KeyTrigger<span class="br0">&#40;</span>KeyInput.<span class="me1">KEY_LEFT</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
inputManager.<span class="me1">addMapping</span><span class="br0">&#40;</span><span class="st0">&quot;Right&quot;</span>, <span class="kw1">new</span> KeyTrigger<span class="br0">&#40;</span>KeyInput.<span class="me1">KEY_D</span><span class="br0">&#41;</span>, 
                                 <span class="kw1">new</span> KeyTrigger<span class="br0">&#40;</span>KeyInput.<span class="me1">KEY_RIGHT</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;</pre>
</div>
<!-- SECTION "2. Add a Trigger Mapping" [2381-3291] -->
<h2><a name="create_listeners" id="create_listeners">3. Create Listeners</a></h2>
<div class="level2">

<p>

The jME3 input manager supports two types of event listeners for inputs:
</p>

<p>
<strong>com.jme3.input.controls.AnalogListener</strong>
</p>
<ul>
<li class="level1"><div class="li"> Use for continuous and gradual actions.</div>
<ul>
<li class="level2"><div class="li"> Examples: Walk, run, rotate, accelerate vehicle, strafe, (semi-)automatic weapon shot</div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> JME gives you access to:</div>
<ul>
<li class="level2"><div class="li"> the name of the triggered action.</div>
</li>
<li class="level2"><div class="li"> a gradual value between 0-9 how long the key has been pressed.</div>
</li>
</ul>
</li>
</ul>

<p>

<strong>com.jme3.input.controls.ActionListener</strong>
</p>
<ul>
<li class="level1"><div class="li"> Use for absolute “pressed or released?”, “on or off?” actions. </div>
<ul>
<li class="level2"><div class="li"> Examples: Pause/unpause, a rifle or revolver shot, jump, click to select.</div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> JME gives you access to:</div>
<ul>
<li class="level2"><div class="li"> the name of the triggered action.</div>
</li>
<li class="level2"><div class="li"> a boolean whether the key is still pressed or has just been released.</div>
</li>
</ul>
</li>
</ul>

<p>

You can use one or both in the same application. Add one or both of these code snippets to your main SimpleApplication-based class to activate the listener.
</p>
<pre class="code java"><span class="kw1">private</span> <object classid="java:org.netbeans.modules.javahelp.BrowserDisplayer"><param name="content" value="http://www.google.com/search?hl=en&amp;q=allinurl%3Aactionlistener+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><param name="text" value="<html><u></u></html>"><param name="textColor" value="blue"></object><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
  <span class="kw1">public</span> <span class="kw4">void</span> onAction<span class="br0">&#40;</span><object classid="java:org.netbeans.modules.javahelp.BrowserDisplayer"><param name="content" value="http://www.google.com/search?hl=en&amp;q=allinurl%3Astring+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><param name="text" value="<html><u></u></html>"><param name="textColor" value="blue"></object> name, <span class="kw4">boolean</span> keyPressed, <span class="kw4">float</span> tpf<span class="br0">&#41;</span> <span class="br0">&#123;</span>
     <span class="co3">/** TODO */</span>
  <span class="br0">&#125;</span>
<span class="br0">&#125;</span>;</pre><pre class="code java"><span class="kw1">private</span> AnalogListener analogListener <span class="sy0">=</span> <span class="kw1">new</span> AnalogListener<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
  <span class="kw1">public</span> <span class="kw4">void</span> onAnalog<span class="br0">&#40;</span><object classid="java:org.netbeans.modules.javahelp.BrowserDisplayer"><param name="content" value="http://www.google.com/search?hl=en&amp;q=allinurl%3Astring+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><param name="text" value="<html><u></u></html>"><param name="textColor" value="blue"></object> name, <span class="kw4">float</span> keyPressed, <span class="kw4">float</span> tpf<span class="br0">&#41;</span> <span class="br0">&#123;</span>
     <span class="co3">/** TODO */</span>
  <span class="br0">&#125;</span>
<span class="br0">&#125;</span>;</pre>
</div>
<!-- SECTION "3. Create Listeners" [3292-4561] -->
<h2><a name="register_mappings_to_listeners" id="register_mappings_to_listeners">4. Register Mappings to Listeners</a></h2>
<div class="level2">

<p>

To activate the mappings, you must register them to the Listener. Write your registration code after the part where you have added the mappings to the inputManager before.
</p>

<p>
In this example, we register the “Pause Game” mapping to the <code>actionListener</code> object, because pausing a game is in “either/or” decision.
</p>
<pre class="code java">inputManager.<span class="me1">addListener</span><span class="br0">&#40;</span>actionListener, <span class="kw1">new</span> <object classid="java:org.netbeans.modules.javahelp.BrowserDisplayer"><param name="content" value="http://www.google.com/search?hl=en&amp;q=allinurl%3Astring+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><param name="text" value="<html><u></u></html>"><param name="textColor" value="blue"></object><span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#123;</span><span class="st0">&quot;Pause Game&quot;</span><span class="br0">&#125;</span><span class="br0">&#41;</span>;</pre>
<p>
In this example, we register navigational mappings to the <code>analogListener</code> object, because walking is a continuous action. Players tend to keep the key pressed to express continuity, for example when they want to “walk on” or “accelerate”.
</p>
<pre class="code java">inputManager.<span class="me1">addListener</span><span class="br0">&#40;</span>analogListener, <span class="kw1">new</span> <object classid="java:org.netbeans.modules.javahelp.BrowserDisplayer"><param name="content" value="http://www.google.com/search?hl=en&amp;q=allinurl%3Astring+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><param name="text" value="<html><u></u></html>"><param name="textColor" value="blue"></object><span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#123;</span><span class="st0">&quot;Left&quot;</span>, <span class="st0">&quot;Right&quot;</span><span class="br0">&#125;</span><span class="br0">&#41;</span>;</pre>
<p>
As you see, you can add several listeners in one String array. You can call the addListener() method more than once, each time with a subset of your list, if that helps you keep you code tidy.
</p>

<p>
<strong>Tip:</strong> Check the string&#039;s capitalization and spelling if you think you have registered an action, but it does not work.
</p>

</div>
<!-- SECTION "4. Register Mappings to Listeners" [4562-5662] -->
<h2><a name="implement_actions" id="implement_actions">5. Implement Actions</a></h2>
<div class="level2">

<p>

You specify the action to be triggered where it says TODO in the Listener code snippets.
Typically you write a series of if/else conditions, testing for all the mapping names, and specifying each action. Here is one example:
</p>
<pre class="code java"><span class="kw1">private</span> AnalogListener analogListener <span class="sy0">=</span> <span class="kw1">new</span> AnalogListener<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">public</span> <span class="kw4">void</span> onAnalog<span class="br0">&#40;</span><object classid="java:org.netbeans.modules.javahelp.BrowserDisplayer"><param name="content" value="http://www.google.com/search?hl=en&amp;q=allinurl%3Astring+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><param name="text" value="<html><u></u></html>"><param name="textColor" value="blue"></object> name, <span class="kw4">float</span> value, <span class="kw4">float</span> tpf<span class="br0">&#41;</span> <span class="br0">&#123;</span>
&nbsp;
      <span class="kw1">if</span> <span class="br0">&#40;</span>name.<span class="me1">equals</span><span class="br0">&#40;</span><span class="st0">&quot;Rotate&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>         <span class="co1">// test?</span>
        player.<span class="me1">rotate</span><span class="br0">&#40;</span>0, value<span class="sy0">*</span>speed, 0<span class="br0">&#41;</span>;  <span class="co1">// action!</span>
      <span class="br0">&#125;</span> <span class="co1">// else if ...</span>
&nbsp;
    <span class="br0">&#125;</span>
  <span class="br0">&#125;</span>;</pre>
<p>
It&#039;s very common that you want an action to be only triggered once, in the moment when the key is released. Examples are when the player presses an action key to open a door or pick up an item, or to flip a game state, such as pause/unpause. For these cases, use an ActionListener and test for <code>&amp;&amp; !keyPressed</code>, like shown in the following example. 
</p>
<pre class="code java"><span class="kw1">private</span> <object classid="java:org.netbeans.modules.javahelp.BrowserDisplayer"><param name="content" value="http://www.google.com/search?hl=en&amp;q=allinurl%3Aactionlistener+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><param name="text" value="<html><u></u></html>"><param name="textColor" value="blue"></object><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">public</span> <span class="kw4">void</span> onAction<span class="br0">&#40;</span><object classid="java:org.netbeans.modules.javahelp.BrowserDisplayer"><param name="content" value="http://www.google.com/search?hl=en&amp;q=allinurl%3Astring+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><param name="text" value="<html><u></u></html>"><param name="textColor" value="blue"></object> name, <span class="kw4">boolean</span> keyPressed, <span class="kw4">float</span> tpf<span class="br0">&#41;</span> <span class="br0">&#123;</span>
&nbsp;
      <span class="kw1">if</span> <span class="br0">&#40;</span>name.<span class="me1">equals</span><span class="br0">&#40;</span><span class="st0">&quot;Pause Game&quot;</span><span class="br0">&#41;</span> <span class="sy0">&amp;&amp;</span> <span class="sy0">!</span>keyPressed<span class="br0">&#41;</span> <span class="br0">&#123;</span> <span class="co1">// test?</span>
        isRunning <span class="sy0">=</span> <span class="sy0">!</span>isRunning;                       <span class="co1">// action!</span>
      <span class="br0">&#125;</span> <span class="co1">// else if ...</span>
&nbsp;
    <span class="br0">&#125;</span>
  <span class="br0">&#125;</span>;</pre>
</div>
<!-- SECTION "5. Implement Actions" [5663-6882] -->
<h2><a name="remapping_keys" id="remapping_keys">Remapping Keys</a></h2>
<div class="level2">

<p>

This approach of separating triggers from actions has the advantage that you can remap triggers easily. Maybe your players have different keyboard layouts, are used to “reversed” mouse navigation, or prefer different navigational keys than the ones you defined. In any case, you only need to replace the trigger parts in the <code>inputManager.addMapping()</code> lines with variables, and load different sets of trigger objects when the game starts. The rest of the code stays as it is.
</p>

</div>
<!-- SECTION "Remapping Keys" [6883-] -->
<p><em><a href="http://jmonkeyengine.org/wiki/doku.php/jme3:advanced:input_handling?do=export_xhtmlbody">view online version</a></em></p>