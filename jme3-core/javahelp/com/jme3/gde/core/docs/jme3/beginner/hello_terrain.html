


<h1><a name="hello_terrain" id="hello_terrain">Hello Terrain</a></h1>
<div class="level1">

<p>

Previous: <a href="/com/jme3/gde/core/docs/jme3/beginner/hello_collision.html" class="wikilink1" title="jme3:beginner:hello_collision">Hello Collision</a>,
Next: <a href="/com/jme3/gde/core/docs/jme3/beginner/hello_audio.html" class="wikilink1" title="jme3:beginner:hello_audio">Hello Audio</a>
</p>

<p>
One way to create a 3D landscape is to sculpt a huge terrain model. This will give you a lot of artistic freedom – but rendering such a huge model can be quite slow. jME supports heightmaps to solve this common performance issue of terrains. 
</p>

<p>
This tutorial explains how to create terrains from heightmaps and how to use splat textures to make the terrain look good.
</p>

<p>
<img src="nbdocs:/com/jme3/gde/core/docs/jme3/beginner/beginner-terrain.png">
</p>

</div>
<!-- SECTION "Hello Terrain" [1-503] -->
<h2><a name="sample_code" id="sample_code">Sample Code</a></h2>
<div class="level2">
<pre class="code java"><span class="kw1">package</span> <span class="co2">jme3test.helloworld</span>;
&nbsp;
<span class="kw1">import</span> <span class="co2">com.jme3.app.SimpleApplication</span>;
<span class="kw1">import</span> <span class="co2">com.jme3.bounding.BoundingBox</span>;
<span class="kw1">import</span> <span class="co2">com.jme3.material.Material</span>;
<span class="kw1">import</span> <span class="co2">com.jme3.math.Vector3f</span>;
<span class="kw1">import</span> <span class="co2">com.jme3.renderer.Camera</span>;
<span class="kw1">import</span> <span class="co2">com.jme3.terrain.geomipmap.TerrainLodControl</span>;
<span class="kw1">import</span> <span class="co2">com.jme3.terrain.heightmap.AbstractHeightMap</span>;
<span class="kw1">import</span> <span class="co2">com.jme3.terrain.geomipmap.TerrainQuad</span>;
<span class="kw1">import</span> <span class="co2">com.jme3.terrain.heightmap.HillHeightMap</span>;
<span class="kw1">import</span> <span class="co2">com.jme3.terrain.heightmap.ImageBasedHeightMap</span>;
<span class="kw1">import</span> <span class="co2">com.jme3.texture.Texture</span>;
<span class="kw1">import</span> <span class="co2">com.jme3.texture.Texture.WrapMode</span>;
<span class="kw1">import</span> <span class="co2">java.util.ArrayList</span>;
<span class="kw1">import</span> <span class="co2">java.util.List</span>;
<span class="kw1">import</span> <span class="co2">jme3tools.converters.ImageToAwt</span>;
&nbsp;
<span class="kw1">public</span> <span class="kw1">class</span> HelloTerrain <span class="kw1">extends</span> SimpleApplication <span class="br0">&#123;</span>
&nbsp;
  <span class="kw1">private</span> TerrainQuad terrain;
  Material mat_terrain;
&nbsp;
  <span class="kw1">public</span> <span class="kw1">static</span> <span class="kw4">void</span> main<span class="br0">&#40;</span><object classid="java:org.netbeans.modules.javahelp.BrowserDisplayer"><param name="content" value="http://www.google.com/search?hl=en&amp;q=allinurl%3Astring+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><param name="text" value="<html><u></u></html>"><param name="textColor" value="blue"></object><span class="br0">&#91;</span><span class="br0">&#93;</span> args<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    HelloTerrain app <span class="sy0">=</span> <span class="kw1">new</span> HelloTerrain<span class="br0">&#40;</span><span class="br0">&#41;</span>;
    app.<span class="me1">start</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
  <span class="br0">&#125;</span>
&nbsp;
  @Override
  <span class="kw1">public</span> <span class="kw4">void</span> simpleInitApp<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    flyCam.<span class="me1">setMoveSpeed</span><span class="br0">&#40;</span><span class="nu0">50</span><span class="br0">&#41;</span>;
&nbsp;
    <span class="co3">/** 1. Create terrain material and load four textures into it. */</span>
    mat_terrain <span class="sy0">=</span> <span class="kw1">new</span> Material<span class="br0">&#40;</span>assetManager, <span class="st0">&quot;Common/MatDefs/Terrain/Terrain.j3md&quot;</span><span class="br0">&#41;</span>;
&nbsp;
    <span class="co3">/** 1.1) Add ALPHA map (for red-blue-green coded splat textures) */</span>
    mat_terrain.<span class="me1">setTexture</span><span class="br0">&#40;</span><span class="st0">&quot;m_Alpha&quot;</span>, 
               assetManager.<span class="me1">loadTexture</span><span class="br0">&#40;</span><span class="st0">&quot;Textures/Terrain/splat/alphamap.png&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
&nbsp;
    <span class="co3">/** 1.2) Add GRASS texture into the red layer (m_Tex1). */</span>
    Texture grass <span class="sy0">=</span> assetManager.<span class="me1">loadTexture</span><span class="br0">&#40;</span><span class="st0">&quot;Textures/Terrain/splat/grass.jpg&quot;</span><span class="br0">&#41;</span>;
    grass.<span class="me1">setWrap</span><span class="br0">&#40;</span>WrapMode.<span class="me1">Repeat</span><span class="br0">&#41;</span>;
    mat_terrain.<span class="me1">setTexture</span><span class="br0">&#40;</span><span class="st0">&quot;m_Tex1&quot;</span>, grass<span class="br0">&#41;</span>;
    mat_terrain.<span class="me1">setFloat</span><span class="br0">&#40;</span><span class="st0">&quot;m_Tex1Scale&quot;</span>, 64f<span class="br0">&#41;</span>;
&nbsp;
    <span class="co3">/** 1.3) Add DIRT texture into the green layer (m_Tex2) */</span>
    Texture dirt <span class="sy0">=</span> assetManager.<span class="me1">loadTexture</span><span class="br0">&#40;</span><span class="st0">&quot;Textures/Terrain/splat/dirt.jpg&quot;</span><span class="br0">&#41;</span>;
    dirt.<span class="me1">setWrap</span><span class="br0">&#40;</span>WrapMode.<span class="me1">Repeat</span><span class="br0">&#41;</span>;
    mat_terrain.<span class="me1">setTexture</span><span class="br0">&#40;</span><span class="st0">&quot;m_Tex2&quot;</span>, dirt<span class="br0">&#41;</span>;
    mat_terrain.<span class="me1">setFloat</span><span class="br0">&#40;</span><span class="st0">&quot;m_Tex2Scale&quot;</span>, 32f<span class="br0">&#41;</span>;
&nbsp;
    <span class="co3">/** 1.4) Add ROAD texture into the blue layer (m_Tex3) */</span>
    Texture rock <span class="sy0">=</span> assetManager.<span class="me1">loadTexture</span><span class="br0">&#40;</span><span class="st0">&quot;Textures/Terrain/splat/road.jpg&quot;</span><span class="br0">&#41;</span>;
    rock.<span class="me1">setWrap</span><span class="br0">&#40;</span>WrapMode.<span class="me1">Repeat</span><span class="br0">&#41;</span>;
    mat_terrain.<span class="me1">setTexture</span><span class="br0">&#40;</span><span class="st0">&quot;m_Tex3&quot;</span>, rock<span class="br0">&#41;</span>;
    mat_terrain.<span class="me1">setFloat</span><span class="br0">&#40;</span><span class="st0">&quot;m_Tex3Scale&quot;</span>, 128f<span class="br0">&#41;</span>;
&nbsp;
    <span class="co3">/** 2. Create the height map */</span>
    AbstractHeightMap heightmap <span class="sy0">=</span> <span class="kw2">null</span>;
    Texture heightMapImage <span class="sy0">=</span> assetManager.<span class="me1">loadTexture</span><span class="br0">&#40;</span><span class="st0">&quot;Textures/Terrain/splat/mountains512.png&quot;</span><span class="br0">&#41;</span>;
    heightmap <span class="sy0">=</span> <span class="kw1">new</span> ImageBasedHeightMap<span class="br0">&#40;</span>
      ImageToAwt.<span class="me1">convert</span><span class="br0">&#40;</span>heightMapImage.<span class="me1">getImage</span><span class="br0">&#40;</span><span class="br0">&#41;</span>, <span class="kw2">false</span>, <span class="kw2">true</span>, 0<span class="br0">&#41;</span><span class="br0">&#41;</span>;
    heightmap.<span class="me1">load</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
    <span class="co3">/** 3. We have prepared material and heightmap. Now we create the actual terrain:
     * 3.1) We create a TerrainQuad and name it &quot;my terrain&quot;.
     * 3.2) A good value for terrain tiles is 64x64 -- so we supply 64+1=65.
     * 3.3) We prepared a heightmap of size 512x512 -- so we supply 512+1=513.
     * 3.4) As LOD step scale we supply Vector3f(1,1,1).
     * 3.5) At last, we supply the prepared heightmap itself.
     */</span>
    terrain <span class="sy0">=</span> <span class="kw1">new</span> TerrainQuad<span class="br0">&#40;</span><span class="st0">&quot;my terrain&quot;</span>, <span class="nu0">65</span>, <span class="nu0">513</span>, heightmap.<span class="me1">getHeightMap</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
&nbsp;
    <span class="co3">/** 4. We give the terrain its material, position &amp; scale it, and attach it. */</span>
    terrain.<span class="me1">setMaterial</span><span class="br0">&#40;</span>mat_terrain<span class="br0">&#41;</span>;
    terrain.<span class="me1">setLocalTranslation</span><span class="br0">&#40;</span>0, <span class="sy0">-</span><span class="nu0">100</span>, 0<span class="br0">&#41;</span>;
    terrain.<span class="me1">setLocalScale</span><span class="br0">&#40;</span>2f, 1f, 2f<span class="br0">&#41;</span>;
    rootNode.<span class="me1">attachChild</span><span class="br0">&#40;</span>terrain<span class="br0">&#41;</span>;
&nbsp;
    <span class="co3">/** 5. The LOD (level of detail) depends on were the camera is: */</span>
    List<span class="sy0">&lt;</span>Camera<span class="sy0">&gt;</span> cameras <span class="sy0">=</span> <span class="kw1">new</span> ArrayList<span class="sy0">&lt;</span>Camera<span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
    cameras.<span class="me1">add</span><span class="br0">&#40;</span>getCamera<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
    TerrainLodControl control <span class="sy0">=</span> <span class="kw1">new</span> TerrainLodControl<span class="br0">&#40;</span>terrain, cameras<span class="br0">&#41;</span>;
    terrain.<span class="me1">addControl</span><span class="br0">&#40;</span>control<span class="br0">&#41;</span>;
&nbsp;
  <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>
<p>
When you run this sample you should see a landscape with dirt mountains, grass plains, plus some winding roads in between. 
</p>

</div>
<!-- SECTION "Sample Code" [504-4083] -->
<h2><a name="what_is_a_heightmap" id="what_is_a_heightmap">What is a Heightmap?</a></h2>
<div class="level2">

<p>

Heightmaps are an efficient way of representing the shape of a hilly landscape. Picture a heightmap as a float array containing height values between 0f and 255f. Here is a very simple example of a heightmap with 25 height values. 
</p>

<p>
<img src="/wiki/lib/exe/fetch.php">
</p>

<p>
Important things to note:
</p>
<ul>
<li class="level1"><div class="li"> Low values (e.g. 0 or 50) are valeys.</div>
</li>
<li class="level1"><div class="li"> High values (e.g. 200, 255) are hills. </div>
</li>
<li class="level1"><div class="li"> We only specified a few points, and the engine interpolates the rest. Interpolation is more efficient than creating a model with several millions of vertices.</div>
</li>
</ul>

<p>

Now when looking at Java data types to hold an array of floats between 0 and 255, the Image class comes to mind. Storing a terrain&#039;s height values as a grayscale image has one big advantage: The outcome is a very userfriendly, almost topographical, representation of a landscape: 
</p>
<ul>
<li class="level1"><div class="li"> Low values (e.g. 0 or 50) are dark gray – these are valleys. </div>
</li>
<li class="level1"><div class="li"> High values (e.g. 200, 255) are light grays – these are hills.</div>
</li>
</ul>

<p>

Look at the next screenshot: In the top left you see the 128&times;128 grayscale image (heightmap) that was used as a base to generate the depicted terrain. To make the hilly shape better visible, the mountain tops are colored white, valleys brown, and the areas inbetween green:
</p>

<p>
<img src="/wiki/lib/exe/fetch.php">
</p>

<p>
In a real game, you will want to use more complex and smoother terrains than the simple heightmaps shown here. Heightmaps typically have square sizes of 512&times;512 or 1024&times;1024, and contain hundred thousands to 1 million height values. No matter which size, the concept is the same as described here. 
</p>

</div>
<!-- SECTION "What is a Heightmap?" [4084-5788] -->
<h3><a name="looking_at_the_heightmap_code" id="looking_at_the_heightmap_code">Looking at the Heightmap Code</a></h3>
<div class="level3">

<p>

<img src="/wiki/lib/exe/fetch.php">
</p>

<p>
The first step is always to create the heightmap. You can create it yourself in any standard graphic application. Make sure it has the following properties:
</p>
<ul>
<li class="level1"><div class="li"> The size must be square and a power of two</div>
<ul>
<li class="level2"><div class="li"> Examples: 128&times;128, 256&times;256, 512&times;512, 1024&times;1024</div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> Color mode: 255 grayscales. </div>
<ul>
<li class="level2"><div class="li"> If you supply a color image, it will be converted to grayscale (with possibly weird results).</div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> Save it as a normal .jpg or .png file</div>
</li>
</ul>

<p>

The file <code>mountains512.png</code> that you see here is a typical example of a heightmap.
</p>

<p>
Here is how you create the heightmap object in your jME code:
</p>
<ol>
<li class="level1"><div class="li"> Create a Texture object</div>
</li>
<li class="level1"><div class="li"> Load your prepared heightmap texture into the texture object</div>
</li>
<li class="level1"><div class="li"> Create an AbstractHeightmap object from an ImageBasedHeightMap. <br/>
 ImageBasedHeightMap expects the following parameters:</div>
<ol>
<li class="level2"><div class="li"> An <code>ImageToAwt.convert()</code>ed image file</div>
</li>
<li class="level2"><div class="li"> A boolean whether you are using 16 bit – here false.</div>
</li>
<li class="level2"><div class="li"> A boolean whether you are using an alphamap – here true.</div>
</li>
</ol>
</li>
<li class="level1"><div class="li"> Load the heightmap.</div>
</li>
</ol>
<pre class="code java">    AbstractHeightMap heightmap <span class="sy0">=</span> <span class="kw2">null</span>;
    Texture heightMapImage <span class="sy0">=</span> assetManager.<span class="me1">loadTexture</span><span class="br0">&#40;</span><span class="st0">&quot;Textures/Terrain/splat/mountains512.png&quot;</span><span class="br0">&#41;</span>;
    heightmap <span class="sy0">=</span> <span class="kw1">new</span> ImageBasedHeightMap<span class="br0">&#40;</span>
      ImageToAwt.<span class="me1">convert</span><span class="br0">&#40;</span>heightMapImage.<span class="me1">getImage</span><span class="br0">&#40;</span><span class="br0">&#41;</span>, <span class="kw2">false</span>, <span class="kw2">true</span>, 0<span class="br0">&#41;</span><span class="br0">&#41;</span>;
    heightmap.<span class="me1">load</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;</pre>
</div>
<!-- SECTION "Looking at the Heightmap Code" [5789-7237] -->
<h2><a name="what_is_texture_splatting" id="what_is_texture_splatting">What is Texture Splatting?</a></h2>
<div class="level2">

<p>

Texture splatting allows you create a custom textured material and “paint” on it. This is very useful for terrains: As you see in the example here, you can paint a grass texture into the valleys, a dirt texture onto the mountains, and free-form roads inbetween.
</p>

<p>
How is it done? We have three texture layers to paint on, <code>m_Tex1</code>, <code>m_Tex2</code> and <code>m_Tex3</code> (these names are found by opening the Terrain.j3md file, under the Material Parameters section; they may be changed) . before we start we have to make a few decisions: 

</p>
<ol>
<li class="level1"><div class="li"> You choose three textures. For example grass.jpg, dirt.jpg, and road.jpg. <img src="/wiki/lib/exe/fetch.php"></div>
</li>
<li class="level1"><div class="li"> You will “paint” three texture layers with three colors: Red, blue and, green. We arbitrarily chose that… </div>
<ol>
<li class="level2"><div class="li"> … everything red will be grass – this goes into layer <code>m_Tex1</code></div>
</li>
<li class="level2"><div class="li"> … everything green will be dirt – this goes into layer <code>m_Tex2</code></div>
</li>
<li class="level2"><div class="li"> … everything blue will be roads – this goes into layer <code>m_Tex3</code> </div>
</li>
</ol>
</li>
</ol>

<p>

Now we start painting the texture: 

</p>
<ol>
<li class="level1"><div class="li"> Make a copy of your terrains heightmap, <code>mountains512.png</code>, so you know the shape of the landscape. </div>
</li>
<li class="level1"><div class="li"> Name the copy <code>alphamap.png</code>.</div>
</li>
<li class="level1"><div class="li"> Open <code>alphamap.png</code> in a graphic editor and switch the image mode to color image.</div>
<ol>
<li class="level2"><div class="li"> Paint the black valleys in the image red – this will be the grass.</div>
</li>
<li class="level2"><div class="li"> Paint the white hills in shades of green – this will be the dirt of the mountains.</div>
</li>
<li class="level2"><div class="li"> Paint blue lines where you want roads to cross the landscape. </div>
</li>
</ol>
</li>
<li class="level1"><div class="li"> The end result should look similar to this:</div>
</li>
</ol>

<p>

<img src="/wiki/lib/exe/fetch.php">
</p>

<p>
<em>Note: In the future, the jMonkeyPlatform will take over some of these steps so you don&#039;t have to worry about the details.</em>
</p>

</div>
<!-- SECTION "What is Texture Splatting?" [7238-9471] -->
<h3><a name="looking_at_the_texturing_code" id="looking_at_the_texturing_code">Looking at the Texturing Code</a></h3>
<div class="level3">

<p>

As usual, we create a Material object. We base it on the Material Definition <code>Terrain.j3md</code> that is included in the jME3 framework.
</p>
<pre class="code java">Material mat_terrain <span class="sy0">=</span> <span class="kw1">new</span> Material<span class="br0">&#40;</span>assetManager, <span class="st0">&quot;Common/MatDefs/Terrain/Terrain.j3md&quot;</span><span class="br0">&#41;</span>;</pre>
<p>
Now we load four textures into this material. The first one, <code>m_Alpha</code>, is the alphamap that we just created. 
</p>
<pre class="code java">mat_terrain.<span class="me1">setTexture</span><span class="br0">&#40;</span><span class="st0">&quot;m_Alpha&quot;</span>, 
    assetManager.<span class="me1">loadTexture</span><span class="br0">&#40;</span><span class="st0">&quot;Textures/Terrain/splat/alphamap.png&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;</pre>
<p>
Three other textures are the layers that we have previously decided to paint: grass, dirt, and road. We create texture objects and load the three textures as usual. Note how we assign them to their respective texture layers (m_Tex1, m_Tex2, and m_Tex3) inside the Material!
</p>
<pre class="code java">    <span class="co3">/** 1.2) Add GRASS texture into the red layer (m_Tex1). */</span>
    Texture grass <span class="sy0">=</span> assetManager.<span class="me1">loadTexture</span><span class="br0">&#40;</span><span class="st0">&quot;Textures/Terrain/splat/grass.jpg&quot;</span><span class="br0">&#41;</span>;
    grass.<span class="me1">setWrap</span><span class="br0">&#40;</span>WrapMode.<span class="me1">Repeat</span><span class="br0">&#41;</span>;
    mat_terrain.<span class="me1">setTexture</span><span class="br0">&#40;</span><span class="st0">&quot;m_Tex1&quot;</span>, grass<span class="br0">&#41;</span>;
    mat_terrain.<span class="me1">setFloat</span><span class="br0">&#40;</span><span class="st0">&quot;m_Tex1Scale&quot;</span>, 64f<span class="br0">&#41;</span>;
&nbsp;
    <span class="co3">/** 1.3) Add DIRT texture into the green layer (m_Tex2) */</span>
    Texture dirt <span class="sy0">=</span> assetManager.<span class="me1">loadTexture</span><span class="br0">&#40;</span><span class="st0">&quot;Textures/Terrain/splat/dirt.jpg&quot;</span><span class="br0">&#41;</span>;
    dirt.<span class="me1">setWrap</span><span class="br0">&#40;</span>WrapMode.<span class="me1">Repeat</span><span class="br0">&#41;</span>;
    mat_terrain.<span class="me1">setTexture</span><span class="br0">&#40;</span><span class="st0">&quot;m_Tex2&quot;</span>, dirt<span class="br0">&#41;</span>;
    mat_terrain.<span class="me1">setFloat</span><span class="br0">&#40;</span><span class="st0">&quot;m_Tex2Scale&quot;</span>, 32f<span class="br0">&#41;</span>;
&nbsp;
    <span class="co3">/** 1.4) Add ROAD texture into the blue layer (m_Tex3) */</span>
    Texture rock <span class="sy0">=</span> assetManager.<span class="me1">loadTexture</span><span class="br0">&#40;</span><span class="st0">&quot;Textures/Terrain/splat/road.jpg&quot;</span><span class="br0">&#41;</span>;
    rock.<span class="me1">setWrap</span><span class="br0">&#40;</span>WrapMode.<span class="me1">Repeat</span><span class="br0">&#41;</span>;
    mat_terrain.<span class="me1">setTexture</span><span class="br0">&#40;</span><span class="st0">&quot;m_Tex3&quot;</span>, rock<span class="br0">&#41;</span>;
    mat_terrain.<span class="me1">setFloat</span><span class="br0">&#40;</span><span class="st0">&quot;m_Tex3Scale&quot;</span>, 128f<span class="br0">&#41;</span>;</pre>
<p>
The individual texture scales (e.g. <code>mat_terrain.setFloat(“m_Tex3Scale”, 128f);</code>) depend on the size of the textures you use. You can tell you picked the wrong scales for the scene if, for example, your road tiles appear like tiny grains of sand, or the blades of grass look like twigs.
</p>

<p>
As you see, we also use <code>setWrap(WrapMode.Repeat)</code> to make the small texture fill the wide area. If the repetition is too visible, try adjusting the Tex*Scale value.
</p>

<p>
Later, after we have created the actual terrain object, we must not forgot to set the material:
</p>
<pre class="code java">terrain.<span class="me1">setMaterial</span><span class="br0">&#40;</span>mat_terrain<span class="br0">&#41;</span>;</pre>
</div>
<!-- SECTION "Looking at the Texturing Code" [9472-11708] -->
<h2><a name="looking_at_the_terrain_generation_code" id="looking_at_the_terrain_generation_code">Looking at the Terrain Generation Code</a></h2>
<div class="level2">

<p>

Internally, the generated terrain mesh is broken down into tiles and blocks. This is an optimization for culling. You do not need to worry about tiles and blocks too much, just use recommended values for now. 
</p>

<p>
Let&#039;s assume we want to generate a small 512&times;512 terrain. We already have created the heightmap object. Here are the steps that we perform everytime we create a new terrain:

</p>
<ol>
<li class="level1"><div class="li"> We create a TerrainQuad and name it. e.g. “my terrain”.</div>
</li>
<li class="level1"><div class="li"> Tile size: We want to create terrain tiles of size 64&times;64, so we supply 64+1 = 65.</div>
<ul>
<li class="level2"><div class="li"> In general, 64 is a good value for terrain tiles. </div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> Block size: Since we prepared a heightmap of size 512&times;512, we supply 512+1 = 513.</div>
<ul>
<li class="level2"><div class="li"> If you supply twice as much as the heightmap size (1024+1=1025), you&#039;d get a stretched out, wider, flatter terrain.</div>
</li>
<li class="level2"><div class="li"> If you supply half as much as the heightmap size (256+1=257), you&#039;d get a smaller, more detailed terrain.</div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> Finally, we supply the 512&times;512 heightmap object that we have previously created.</div>
</li>
</ol>
<pre class="code">terrain = new TerrainQuad(
  &quot;my terrain&quot;,               // name
  65,                         // tile size
  513,                        // block size
  heightmap.getHeightMap());  // heightmap
</pre>

<p>
Don&#039;t forget to attach the terrain to the rootNode. You can scale and translate the terrain just like any other Spatial.
</p>

</div>
<!-- SECTION "Looking at the Terrain Generation Code" [11709-13087] -->
<h2><a name="looking_at_the_level_of_detail_code" id="looking_at_the_level_of_detail_code">Looking at the Level of Detail Code</a></h2>
<div class="level2">

<p>

jME3 includes an optimization that adjusts the level of detail of the rendered terrain depending on how close or far the camera is. 
</p>
<pre class="code java">    List<span class="sy0">&lt;</span>Camera<span class="sy0">&gt;</span> cameras <span class="sy0">=</span> <span class="kw1">new</span> ArrayList<span class="sy0">&lt;</span>Camera<span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
    cameras.<span class="me1">add</span><span class="br0">&#40;</span>getCamera<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
    TerrainLodControl control <span class="sy0">=</span> <span class="kw1">new</span> TerrainLodControl<span class="br0">&#40;</span>terrain, cameras<span class="br0">&#41;</span>;
    terrain.<span class="me1">addControl</span><span class="br0">&#40;</span>control<span class="br0">&#41;</span>;</pre>
<p>
Close parts of the terrain are rendered in full detail. Terrain parts that are further away are not clearly visible anyway, and jME improves performance by rendering them less detailed. This way you can afford to load huge terrains with no penalty caused by invisible details. 
</p>

</div>
<!-- SECTION "Looking at the Level of Detail Code" [13088-13758] -->
<h2><a name="exercises" id="exercises">Exercises</a></h2>
<div class="level2">

</div>
<!-- SECTION "Exercises" [13759-13781] -->
<h3><a name="exercise_1texture_layers" id="exercise_1texture_layers">Exercise 1: Texture Layers</a></h3>
<div class="level3">

<p>

What happens if you swap two layers, for example <code>m_Tex1</code> and <code>m_Tex2</code>?

</p>
<pre class="code java">...
<span class="me1">mat_terrain</span>.<span class="me1">setTexture</span><span class="br0">&#40;</span><span class="st0">&quot;m_Tex2&quot;</span>, grass<span class="br0">&#41;</span>;
...
<span class="me1">mat_terrain</span>.<span class="me1">setTexture</span><span class="br0">&#40;</span><span class="st0">&quot;m_Tex1&quot;</span>, dirt<span class="br0">&#41;</span>;</pre>
<p>
It&#039;s easier to swap layers in the code than to change the color in the alphamap.
</p>

</div>
<!-- SECTION "Exercise 1: Texture Layers" [13782-14087] -->
<h3><a name="exercise_2randomized_terrains" id="exercise_2randomized_terrains">Exercise 2: Randomized Terrains</a></h3>
<div class="level3">

<p>

These two lines generate the hightmap from a user defined image:

</p>
<pre class="code java">Texture heightMapImage <span class="sy0">=</span> assetManager.<span class="me1">loadTexture</span><span class="br0">&#40;</span><span class="st0">&quot;Textures/Terrain/splat/mountains512.png&quot;</span><span class="br0">&#41;</span>;
    heightmap <span class="sy0">=</span> <span class="kw1">new</span> ImageBasedHeightMap<span class="br0">&#40;</span>
      ImageToAwt.<span class="me1">convert</span><span class="br0">&#40;</span>heightMapImage.<span class="me1">getImage</span><span class="br0">&#40;</span><span class="br0">&#41;</span>, <span class="kw2">false</span>, <span class="kw2">true</span>, 0<span class="br0">&#41;</span>, 1f<span class="br0">&#41;</span>;</pre>
<p>

You can also let jME create a random landscape. 

</p>
<ol>
<li class="level1"><div class="li"> What result do you get when you replace the two heightmap lines by the following two lines and run the sample?</div>
</li>
</ol>
<pre class="code java">    <span class="kw1">try</span> <span class="br0">&#123;</span> heightmap <span class="sy0">=</span> <span class="kw1">new</span> HillHeightMap<span class="br0">&#40;</span><span class="nu0">1025</span>, <span class="nu0">1000</span>, <span class="nu0">50</span>, <span class="nu0">100</span>, <span class="br0">&#40;</span><span class="kw4">byte</span><span class="br0">&#41;</span> <span class="nu0">3</span><span class="br0">&#41;</span>;
    <span class="br0">&#125;</span> <span class="kw1">catch</span> <span class="br0">&#40;</span><object classid="java:org.netbeans.modules.javahelp.BrowserDisplayer"><param name="content" value="http://www.google.com/search?hl=en&amp;q=allinurl%3Aexception+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><param name="text" value="<html><u></u></html>"><param name="textColor" value="blue"></object> ex<span class="br0">&#41;</span> <span class="br0">&#123;</span> ex.<span class="me1">printStackTrace</span><span class="br0">&#40;</span><span class="br0">&#41;</span>; <span class="br0">&#125;</span></pre><ol>
<li class="level1"><div class="li"> Change one value at a time and the run the sample again. Note the differences. Can you find out which of the values has which effect on the generated terrain?</div>
<ul>
<li class="level2"><div class="li"> Which value controls the size? </div>
<ul>
<li class="level3"><div class="li"> What happens if the size is not a square number +1 ?</div>
</li>
</ul>
</li>
<li class="level2"><div class="li"> Which value controls the number of hills generated?</div>
</li>
<li class="level2"><div class="li"> Which values control the minimum and maximum radius of the hills?</div>
<ul>
<li class="level3"><div class="li"> What happens if the minimum is bigger than the maximum?</div>
</li>
</ul>
</li>
<li class="level2"><div class="li"> Which value controls the flattening of the hills? </div>
<ul>
<li class="level3"><div class="li"> What happens if this value is 1 ?</div>
</li>
</ul>
</li>
</ul>
</li>
</ol>

<p>

Tip: You can keep using the splatted texture from the sample code above. Just don&#039;t be surprised that the textures do not automatically adjust to the randomized landscape. 
</p>

</div>
<!-- SECTION "Exercise 2: Randomized Terrains" [14088-15461] -->
<h2><a name="conclusion" id="conclusion">Conclusion</a></h2>
<div class="level2">

<p>

You have learned how to create terrains that are more efficient as loading a giant model. You are now also able to texture a terrain.
</p>

<p>
In the next chapter, you will learn how to add <a href="/com/jme3/gde/core/docs/jme3/beginner/hello_audio.html" class="wikilink1" title="jme3:beginner:hello_audio">sounds</a> to your game.

</p>
<hr />

<p>
See also: <a href="/com/jme3/gde/core/docs/jme3/intermediate/terrain_collision.html" class="wikilink1" title="jme3:intermediate:terrain_collision">Terrain Collision</a>
</p>

</div>
<!-- SECTION "Conclusion" [15462-] -->
<p><em><a href="http://jmonkeyengine.org/wiki/doku.php/jme3:beginner:hello_terrain?do=export_xhtmlbody">view online version</a></em></p>