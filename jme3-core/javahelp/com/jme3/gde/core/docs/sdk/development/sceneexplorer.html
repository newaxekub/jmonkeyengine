
<h1><a>The SceneExplorer</a></h1>
<div>

</div>

<h2><a>Adding Node types to SceneExplorer</a></h2>
<div>

<p>

If your plugin brings in its own SceneGraph objects you can still have them work like any other SceneExplorer item, including its special properties.
</p>

<p>
<br/>

You will have to create your own class that extends org.openide.nodes.Node and implement the interface com.jme3.gde.core.sceneexplorer.nodes.SceneExplorerNode. Then you register that class by adding 
</p>
<pre>@org.openide.util.lookup.ServiceProvider(service=com.jme3.gde.core.sceneexplorer.nodes.SceneExplorerNode.class)</pre>

<p>
 above the “public class MyClass” line in your class. Thats all, your Spatial type will automatically be used and displayed in the SceneExplorer.
</p>

<p>
<br/>

Theres also AbstractSceneExplorerNode which brings some other useful features you might want to include like automatic creation of properly threaded properties etc. JmeSpatial for example bases on it. A simple SceneExplorerNode example for an object extending Spatial would be JmeGeometry (see below).
</p>

<p>
The SceneExplorerNode can be used for Spatial and Control type objects.
</p>

</div>

<h3><a>Spatial Example</a></h3>
<div>
<pre>@org.openide.util.lookup.ServiceProvider&#40;service=SceneExplorerNode.class&#41;
public class JmeGeometry extends JmeSpatial &#123;
&nbsp;
    private static Image smallImage =
            ImageUtilities.loadImage&#40;&quot;com/jme3/gde/core/sceneexplorer/nodes/icons/geometry.gif&quot;&#41;;
    private Geometry geom;
&nbsp;
    public JmeGeometry&#40;&#41; &#123;
    &#125;
&nbsp;
    public JmeGeometry&#40;Geometry spatial, SceneExplorerChildren children&#41; &#123;
        super&#40;spatial, children&#41;;
        getLookupContents&#40;&#41;.add&#40;spatial&#41;;
        this.geom = spatial;
        setName&#40;spatial.getName&#40;&#41;&#41;;
    &#125;
&nbsp;
    @Override
    public Image getIcon&#40;int type&#41; &#123;
        return smallImage;
    &#125;
&nbsp;
    @Override
    public Image getOpenedIcon&#40;int type&#41; &#123;
        return smallImage;
    &#125;
&nbsp;
    @Override
    protected Sheet createSheet&#40;&#41; &#123;
        Sheet sheet = super.createSheet&#40;&#41;;
        Sheet.Set set = Sheet.createPropertiesSet&#40;&#41;;
        set.setDisplayName&#40;&quot;Geometry&quot;&#41;;
        set.setName&#40;Geometry.class.getName&#40;&#41;&#41;;
        Geometry obj = geom;//getLookup().lookup(Geometry.class);
        if &#40;obj == null&#41; &#123;
            return sheet;
        &#125;
&nbsp;
        set.put&#40;makeProperty&#40;obj, int.class, &quot;getLodLevel&quot;, &quot;setLodLevel&quot;, &quot;Lod Level&quot;&#41;&#41;;
        set.put&#40;makeProperty&#40;obj, Material.class, &quot;getMaterial&quot;, &quot;setMaterial&quot;, &quot;Material&quot;&#41;&#41;;
        set.put&#40;makeProperty&#40;obj, Mesh.class, &quot;getMesh&quot;, &quot;Mesh&quot;&#41;&#41;;
&nbsp;
        sheet.put&#40;set&#41;;
        return sheet;
&nbsp;
    &#125;
&nbsp;
    public Class getExplorerObjectClass&#40;&#41; &#123;
        return Geometry.class;
    &#125;
&nbsp;
    public Class getExplorerNodeClass&#40;&#41; &#123;
        return JmeGeometry.class;
    &#125;
&nbsp;
    public org.openide.nodes.Node&#91;&#93; createNodes&#40;Object key2, boolean readOnly&#41; &#123;
        SceneExplorerChildren children=new SceneExplorerChildren&#40;&#40;com.jme3.scene.Spatial&#41;key&#41;;
        children.setReadOnly&#40;readOnly&#41;;
        return new org.openide.nodes.Node&#91;&#93;&#123;new JmeGeometry&#40;&#40;Geometry&#41; key, children&#41;.setReadOnly&#40;readOnly&#41;&#125;;
    &#125;
&#125;</pre>
</div>

<h3><a>Control Example</a></h3>
<div>
<pre>@org.openide.util.lookup.ServiceProvider&#40;service=SceneExplorerNode.class&#41;
public class JmeGhostControl extends AbstractSceneExplorerNode &#123;
&nbsp;
    private static Image smallImage =
            ImageUtilities.loadImage&#40;&quot;com/jme3/gde/core/sceneexplorer/nodes/icons/ghostcontrol.gif&quot;&#41;;
    private GhostControl geom;
&nbsp;
    public JmeGhostControl&#40;&#41; &#123;
    &#125;
&nbsp;
    public JmeGhostControl&#40;GhostControl spatial, DataObject dataObject&#41; &#123;
        super&#40;dataObject&#41;;
        getLookupContents&#40;&#41;.add&#40;this&#41;;
        getLookupContents&#40;&#41;.add&#40;spatial&#41;;
        this.geom = spatial;
        setName&#40;&quot;GhostControl&quot;&#41;;
    &#125;
&nbsp;
    @Override
    public Image getIcon&#40;int type&#41; &#123;
        return smallImage;
    &#125;
&nbsp;
    @Override
    public Image getOpenedIcon&#40;int type&#41; &#123;
        return smallImage;
    &#125;
&nbsp;
    protected SystemAction&#91;&#93; createActions&#40;&#41; &#123;
        return new SystemAction&#91;&#93;&#123;
                    //                    SystemAction.get(CopyAction.class),
                    //                    SystemAction.get(CutAction.class),
                    //                    SystemAction.get(PasteAction.class),
                    SystemAction.get&#40;DeleteAction.class&#41;
                &#125;;
    &#125;
&nbsp;
    @Override
    public boolean canDestroy&#40;&#41; &#123;
        return !readOnly;
    &#125;
&nbsp;
    @Override
    public void destroy&#40;&#41; throws IOException &#123;
        super.destroy&#40;&#41;;
        final Spatial spat=getParentNode&#40;&#41;.getLookup&#40;&#41;.lookup&#40;Spatial.class&#41;;
        try &#123;
            SceneApplication.getApplication&#40;&#41;.enqueue&#40;new Callable&lt;Void&gt;&#40;&#41; &#123;
&nbsp;
                public Exception &#123;
                    spat.removeControl&#40;geom&#41;;
                    return null;
                &#125;
            &#125;&#41;.get&#40;&#41;;
            &#40;&#40;AbstractSceneExplorerNode&#41;getParentNode&#40;&#41;&#41;.refresh&#40;true&#41;;
        &#125; catch &#40;InterruptedException ex&#41; &#123;
            Exceptions.printStackTrace&#40;ex&#41;;
        &#125; catch &#40;ExecutionException ex&#41; &#123;
            Exceptions.printStackTrace&#40;ex&#41;;
        &#125;
    &#125;
&nbsp;
    @Override
    protected Sheet createSheet&#40;&#41; &#123;
        Sheet sheet = super.createSheet&#40;&#41;;
        Sheet.Set set = Sheet.createPropertiesSet&#40;&#41;;
        set.setDisplayName&#40;&quot;GhostControl&quot;&#41;;
        set.setName&#40;GhostControl.class.getName&#40;&#41;&#41;;
        GhostControl obj = geom;//getLookup().lookup(Spatial.class);
        if &#40;obj == null&#41; &#123;
            return sheet;
        &#125;
&nbsp;
        set.put&#40;makeProperty&#40;obj, Vector3f.class, &quot;getPhysicsLocation&quot;, &quot;setPhysicsLocation&quot;, &quot;Physics Location&quot;&#41;&#41;;
        set.put&#40;makeProperty&#40;obj, Quaternion.class, &quot;getPhysicsRotation&quot;, &quot;setPhysicsRotation&quot;, &quot;Physics Rotation&quot;&#41;&#41;;
&nbsp;
        set.put&#40;makeProperty&#40;obj, CollisionShape.class, &quot;getCollisionShape&quot;, &quot;setCollisionShape&quot;, &quot;Collision Shape&quot;&#41;&#41;;
        set.put&#40;makeProperty&#40;obj, int.class, &quot;getCollisionGroup&quot;, &quot;setCollisionGroup&quot;, &quot;Collision Group&quot;&#41;&#41;;
        set.put&#40;makeProperty&#40;obj, int.class, &quot;getCollideWithGroups&quot;, &quot;setCollideWithGroups&quot;, &quot;Collide With Groups&quot;&#41;&#41;;
&nbsp;
        sheet.put&#40;set&#41;;
        return sheet;
&nbsp;
    &#125;
&nbsp;
    public Class getExplorerObjectClass&#40;&#41; &#123;
        return GhostControl.class;
    &#125;
&nbsp;
    public Class getExplorerNodeClass&#40;&#41; &#123;
        return JmeGhostControl.class;
    &#125;
&nbsp;
    public org.openide.nodes.Node&#91;&#93; createNodes&#40;Object key, DataObject key2, boolean cookie&#41; &#123;
        return new org.openide.nodes.Node&#91;&#93;&#123;new JmeGhostControl&#40;&#40;GhostControl&#41; key, key2&#41;.setReadOnly&#40;cookie&#41;&#125;;
    &#125;
&#125;</pre>
</div>

<h2><a>Adding items to the add and tools menus</a></h2>
<div>

<p>
For adding Spatials, Contols and for general tools theres premade abstract classes that you can use to extend the options. Undo/Redo is handled by the abstract class.
</p>

<p>
<p><div>Note that the classes you create are singletons which are used across multiple nodes and you should not store any data in local variables!
</div></p>
</p>

<p>
To add a new Tool, use the AbstractToolAction:
</p>
<pre>@org.openide.util.lookup.ServiceProvider&#40;service = ToolAction.class&#41;
public class GenerateTangentsTool extends AbstractToolAction &#123;
&nbsp;
    public GenerateTangentsTool&#40;&#41; &#123;
        name = &quot;Generate Tangents&quot;;
    &#125;
&nbsp;
    @Override
    protected boolean doApplyTool&#40;AbstractSceneExplorerNode rootNode&#41; &#123;
        Geometry geom = rootNode.getLookup&#40;&#41;.lookup&#40;Geometry.class&#41;;
        Mesh mesh = geom.getMesh&#40;&#41;;
        if &#40;mesh != null&#41; &#123;
            TangentBinormalGenerator.generate&#40;mesh&#41;;
        &#125;
        return true;
    &#125;
&nbsp;
    @Override
    protected void doUndoTool&#40;AbstractSceneExplorerNode rootNode&#41; &#123;
        Geometry geom = rootNode.getLookup&#40;&#41;.lookup&#40;Geometry.class&#41;;
        Mesh mesh = geom.getMesh&#40;&#41;;
        if &#40;mesh != null&#41; &#123;
            mesh.clearBuffer&#40;Type.Tangent&#41;;
        &#125;
    &#125;
&nbsp;
    public Class&lt;?&gt; getNodeClass&#40;&#41; &#123;
        return JmeGeometry.class;
    &#125;
&nbsp;
&#125;</pre>
<p>
For a new Spatial or Control, use AbstractNewSpatialAction
</p>
<pre>@org.openide.util.lookup.ServiceProvider&#40;service = NewSpatialAction.class&#41;
public class NewSpecialSpatialAction extends AbstractNewSpatialAction &#123;
&nbsp;
    public NewSpecialSpatialAction&#40;&#41; &#123;
        name = &quot;Spatial&quot;;
    &#125;
&nbsp;
    @Override
    protected Spatial doCreateSpatial&#40;Node parent&#41; &#123;
        Spatial spatial=new Node&#40;&#41;;
        return spatial;
    &#125;
&#125;</pre>
<p>

 
or AbstractNewControlAction:
</p>
<pre>@org.openide.util.lookup.ServiceProvider&#40;service = NewControlAction.class&#41;
public class NewRigidBodyAction extends AbstractNewControlAction &#123;
&nbsp;
    public NewRigidBodyAction&#40;&#41; &#123;
        name = &quot;Static RigidBody&quot;;
    &#125;
&nbsp;
    @Override
    protected Control doCreateControl&#40;Spatial spatial&#41; &#123;
        RigidBodyControl control = spatial.getControl&#40;RigidBodyControl.class&#41;;
        if &#40;control != null&#41; &#123;
            spatial.removeControl&#40;control&#41;;
        &#125;
        Node parent = spatial.getParent&#40;&#41;;
        spatial.removeFromParent&#40;&#41;;
        control = new RigidBodyControl&#40;0&#41;;
        if &#40;parent != null&#41; &#123;
            parent.attachChild&#40;spatial&#41;;
        &#125;
        return control;
    &#125;
&#125;</pre>
</div>
<p><em><a href="http://jmonkeyengine.org/wiki/doku.php/sdk:development:sceneexplorer?do=export_xhtmlbody">view online version</a></em></p>